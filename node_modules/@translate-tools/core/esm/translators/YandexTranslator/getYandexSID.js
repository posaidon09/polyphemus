// Source: https://github.com/FilipePS/Traduzir-paginas-web/blob/f3a4956a1aa96b7a9124864158a5200827694521/background/translationService.js
var lastYandexRequestSIDTime = null;
var yandexTranslateSID = null;
var yandexSIDNotFound = false;
export function getYandexSID() {
    return new Promise(function (resolve) {
        var updateYandexSid = false;
        if (lastYandexRequestSIDTime) {
            var date = new Date();
            if (yandexTranslateSID) {
                date.setHours(date.getHours() - 12);
            }
            else if (yandexSIDNotFound) {
                date.setMinutes(date.getMinutes() - 30);
            }
            else {
                date.setMinutes(date.getMinutes() - 2);
            }
            if (date.getTime() > lastYandexRequestSIDTime) {
                updateYandexSid = true;
            }
        }
        else {
            updateYandexSid = true;
        }
        if (updateYandexSid) {
            lastYandexRequestSIDTime = Date.now();
            var http_1 = new XMLHttpRequest();
            http_1.open('GET', 'https://translate.yandex.net/website-widget/v1/widget.js?widgetId=ytWidget&pageLang=es&widgetTheme=light&autoMode=false');
            http_1.send();
            http_1.onload = function () {
                var result = http_1.responseText.match(/sid\:\s\'[0-9a-f\.]+/);
                if (result && result[0] && result[0].length > 7) {
                    yandexTranslateSID = result[0].substring(6);
                    yandexSIDNotFound = false;
                }
                else {
                    yandexSIDNotFound = true;
                }
                resolve();
            };
            http_1.onerror = function (e) {
                console.error(e);
                resolve();
            };
        }
        else {
            resolve();
        }
    }).then(function () { return yandexTranslateSID; });
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyYW5zbGF0b3JzL1lhbmRleFRyYW5zbGF0b3IvZ2V0WWFuZGV4U0lELnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDBJQUEwSTtBQUUxSSxJQUFJLHdCQUF3QixHQUFrQixJQUFJLENBQUM7QUFDbkQsSUFBSSxrQkFBa0IsR0FBa0IsSUFBSSxDQUFDO0FBQzdDLElBQUksaUJBQWlCLEdBQVksS0FBSyxDQUFDO0FBRXZDLE1BQU0sVUFBVSxZQUFZO0lBQzNCLE9BQU8sSUFBSSxPQUFPLENBQU8sVUFBQyxPQUFPO1FBQ2hDLElBQUksZUFBZSxHQUFHLEtBQUssQ0FBQztRQUM1QixJQUFJLHdCQUF3QixFQUFFO1lBQzdCLElBQU0sSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7WUFDeEIsSUFBSSxrQkFBa0IsRUFBRTtnQkFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7YUFDcEM7aUJBQU0sSUFBSSxpQkFBaUIsRUFBRTtnQkFDN0IsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7YUFDeEM7aUJBQU07Z0JBQ04sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7YUFDdkM7WUFDRCxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyx3QkFBd0IsRUFBRTtnQkFDOUMsZUFBZSxHQUFHLElBQUksQ0FBQzthQUN2QjtTQUNEO2FBQU07WUFDTixlQUFlLEdBQUcsSUFBSSxDQUFDO1NBQ3ZCO1FBRUQsSUFBSSxlQUFlLEVBQUU7WUFDcEIsd0JBQXdCLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBRXRDLElBQU0sTUFBSSxHQUFHLElBQUksY0FBYyxFQUFFLENBQUM7WUFDbEMsTUFBSSxDQUFDLElBQUksQ0FDUixLQUFLLEVBQ0wseUhBQXlILENBQ3pILENBQUM7WUFDRixNQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDWixNQUFJLENBQUMsTUFBTSxHQUFHO2dCQUNiLElBQU0sTUFBTSxHQUFHLE1BQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLHNCQUFzQixDQUFDLENBQUM7Z0JBQy9ELElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtvQkFDaEQsa0JBQWtCLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDNUMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDO2lCQUMxQjtxQkFBTTtvQkFDTixpQkFBaUIsR0FBRyxJQUFJLENBQUM7aUJBQ3pCO2dCQUNELE9BQU8sRUFBRSxDQUFDO1lBQ1gsQ0FBQyxDQUFDO1lBQ0YsTUFBSSxDQUFDLE9BQU8sR0FBRyxVQUFDLENBQUM7Z0JBQ2hCLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pCLE9BQU8sRUFBRSxDQUFDO1lBQ1gsQ0FBQyxDQUFDO1NBQ0Y7YUFBTTtZQUNOLE9BQU8sRUFBRSxDQUFDO1NBQ1Y7SUFDRixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBTSxPQUFBLGtCQUFrQixFQUFsQixDQUFrQixDQUFDLENBQUM7QUFDbkMsQ0FBQyIsImZpbGUiOiJ0cmFuc2xhdG9ycy9ZYW5kZXhUcmFuc2xhdG9yL2dldFlhbmRleFNJRC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL0ZpbGlwZVBTL1RyYWR1emlyLXBhZ2luYXMtd2ViL2Jsb2IvZjNhNDk1NmExYWE5NmI3YTkxMjQ4NjQxNThhNTIwMDgyNzY5NDUyMS9iYWNrZ3JvdW5kL3RyYW5zbGF0aW9uU2VydmljZS5qc1xuXG5sZXQgbGFzdFlhbmRleFJlcXVlc3RTSURUaW1lOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbmxldCB5YW5kZXhUcmFuc2xhdGVTSUQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xubGV0IHlhbmRleFNJRE5vdEZvdW5kOiBib29sZWFuID0gZmFsc2U7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRZYW5kZXhTSUQoKSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSkgPT4ge1xuXHRcdGxldCB1cGRhdGVZYW5kZXhTaWQgPSBmYWxzZTtcblx0XHRpZiAobGFzdFlhbmRleFJlcXVlc3RTSURUaW1lKSB7XG5cdFx0XHRjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcblx0XHRcdGlmICh5YW5kZXhUcmFuc2xhdGVTSUQpIHtcblx0XHRcdFx0ZGF0ZS5zZXRIb3VycyhkYXRlLmdldEhvdXJzKCkgLSAxMik7XG5cdFx0XHR9IGVsc2UgaWYgKHlhbmRleFNJRE5vdEZvdW5kKSB7XG5cdFx0XHRcdGRhdGUuc2V0TWludXRlcyhkYXRlLmdldE1pbnV0ZXMoKSAtIDMwKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRhdGUuc2V0TWludXRlcyhkYXRlLmdldE1pbnV0ZXMoKSAtIDIpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGRhdGUuZ2V0VGltZSgpID4gbGFzdFlhbmRleFJlcXVlc3RTSURUaW1lKSB7XG5cdFx0XHRcdHVwZGF0ZVlhbmRleFNpZCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHVwZGF0ZVlhbmRleFNpZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKHVwZGF0ZVlhbmRleFNpZCkge1xuXHRcdFx0bGFzdFlhbmRleFJlcXVlc3RTSURUaW1lID0gRGF0ZS5ub3coKTtcblxuXHRcdFx0Y29uc3QgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdFx0aHR0cC5vcGVuKFxuXHRcdFx0XHQnR0VUJyxcblx0XHRcdFx0J2h0dHBzOi8vdHJhbnNsYXRlLnlhbmRleC5uZXQvd2Vic2l0ZS13aWRnZXQvdjEvd2lkZ2V0LmpzP3dpZGdldElkPXl0V2lkZ2V0JnBhZ2VMYW5nPWVzJndpZGdldFRoZW1lPWxpZ2h0JmF1dG9Nb2RlPWZhbHNlJyxcblx0XHRcdCk7XG5cdFx0XHRodHRwLnNlbmQoKTtcblx0XHRcdGh0dHAub25sb2FkID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBodHRwLnJlc3BvbnNlVGV4dC5tYXRjaCgvc2lkXFw6XFxzXFwnWzAtOWEtZlxcLl0rLyk7XG5cdFx0XHRcdGlmIChyZXN1bHQgJiYgcmVzdWx0WzBdICYmIHJlc3VsdFswXS5sZW5ndGggPiA3KSB7XG5cdFx0XHRcdFx0eWFuZGV4VHJhbnNsYXRlU0lEID0gcmVzdWx0WzBdLnN1YnN0cmluZyg2KTtcblx0XHRcdFx0XHR5YW5kZXhTSUROb3RGb3VuZCA9IGZhbHNlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHlhbmRleFNJRE5vdEZvdW5kID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9O1xuXHRcdFx0aHR0cC5vbmVycm9yID0gKGUpID0+IHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihlKTtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVzb2x2ZSgpO1xuXHRcdH1cblx0fSkudGhlbigoKSA9PiB5YW5kZXhUcmFuc2xhdGVTSUQpO1xufVxuIl19
