"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getToken = getToken;
// TKK value from https://github.com/FilipePS/Traduzir-paginas-web/blob/f3a4956a1aa96b7a9124864158a5200827694521/background/translationService.js
const googleTranslateTKK = '448487.932609646'; //
// Obfuscated logic: START
//

/* eslint-disable no-bitwise */

function shiftLeftOrRightThenSumOrXor(num, optString) {
  for (let i = 0; i < optString.length - 2; i += 3) {
    let acc = optString.charAt(i + 2);

    if ('a' <= acc) {
      acc = acc.charCodeAt(0) - 87;
    } else {
      acc = Number(acc);
    }

    if (optString.charAt(i + 1) == '+') {
      acc = num >>> acc;
    } else {
      acc = num << acc;
    }

    if (optString.charAt(i) == '+') {
      num += acc & 4294967295;
    } else {
      num ^= acc;
    }
  }

  return num;
}

function transformQuery(query) {
  const bytesArray = [];
  let idx = [];

  for (let i = 0; i < query.length; i++) {
    let charCode = query.charCodeAt(i);

    if (128 > charCode) {
      bytesArray[idx++] = charCode;
    } else {
      if (2048 > charCode) {
        bytesArray[idx++] = charCode >> 6 | 192;
      } else {
        if (55296 == (charCode & 64512) && i + 1 < query.length && 56320 == (query.charCodeAt(i + 1) & 64512)) {
          charCode = 65536 + ((charCode & 1023) << 10) + (query.charCodeAt(++i) & 1023);
          bytesArray[idx++] = charCode >> 18 | 240;
          bytesArray[idx++] = charCode >> 12 & 63 | 128;
        } else {
          bytesArray[idx++] = charCode >> 12 | 224;
        }

        bytesArray[idx++] = charCode >> 6 & 63 | 128;
      }

      bytesArray[idx++] = charCode & 63 | 128;
    }
  }

  return bytesArray;
}

function calcHash(query, windowTkk) {
  const tkkSplited = windowTkk.split('.');
  const tkkIndex = Number(tkkSplited[0]) || 0;
  const tkkKey = Number(tkkSplited[1]) || 0;
  const bytesArray = transformQuery(query);
  let encondingRound = tkkIndex;

  for (let i = 0; i < bytesArray.length; i++) {
    encondingRound += bytesArray[i];
    encondingRound = shiftLeftOrRightThenSumOrXor(encondingRound, '+-a^+6');
  }

  encondingRound = shiftLeftOrRightThenSumOrXor(encondingRound, '+-3^+b+-f');
  encondingRound ^= tkkKey;

  if (encondingRound <= 0) {
    encondingRound = (encondingRound & 2147483647) + 2147483648;
  }

  const normalizedResult = encondingRound % 1000000;
  return normalizedResult.toString() + '.' + (normalizedResult ^ tkkIndex);
}
/* eslint-enable no-bitwise */
//
// Obfuscated logic: END
//


function getToken(query) {
  return new Promise(res => res({
    value: calcHash(query, googleTranslateTKK)
  }));
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyYW5zbGF0b3JzL0dvb2dsZVRyYW5zbGF0b3IvdG9rZW4uanMiXSwibmFtZXMiOlsiZ29vZ2xlVHJhbnNsYXRlVEtLIiwic2hpZnRMZWZ0T3JSaWdodFRoZW5TdW1PclhvciIsIm51bSIsIm9wdFN0cmluZyIsImkiLCJsZW5ndGgiLCJhY2MiLCJjaGFyQXQiLCJjaGFyQ29kZUF0IiwiTnVtYmVyIiwidHJhbnNmb3JtUXVlcnkiLCJxdWVyeSIsImJ5dGVzQXJyYXkiLCJpZHgiLCJjaGFyQ29kZSIsImNhbGNIYXNoIiwid2luZG93VGtrIiwidGtrU3BsaXRlZCIsInNwbGl0IiwidGtrSW5kZXgiLCJ0a2tLZXkiLCJlbmNvbmRpbmdSb3VuZCIsIm5vcm1hbGl6ZWRSZXN1bHQiLCJ0b1N0cmluZyIsImdldFRva2VuIiwiUHJvbWlzZSIsInJlcyIsInZhbHVlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBLE1BQU1BLGtCQUFrQixHQUFHLGtCQUEzQixDLENBRUE7QUFDQTtBQUNBOztBQUNBOztBQUVBLFNBQVNDLDRCQUFULENBQXNDQyxHQUF0QyxFQUEyQ0MsU0FBM0MsRUFBc0Q7QUFDckQsT0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHRCxTQUFTLENBQUNFLE1BQVYsR0FBbUIsQ0FBdkMsRUFBMENELENBQUMsSUFBSSxDQUEvQyxFQUFrRDtBQUNqRCxRQUFJRSxHQUFHLEdBQUdILFNBQVMsQ0FBQ0ksTUFBVixDQUFpQkgsQ0FBQyxHQUFHLENBQXJCLENBQVY7O0FBQ0EsUUFBSSxPQUFPRSxHQUFYLEVBQWdCO0FBQ2ZBLE1BQUFBLEdBQUcsR0FBR0EsR0FBRyxDQUFDRSxVQUFKLENBQWUsQ0FBZixJQUFvQixFQUExQjtBQUNBLEtBRkQsTUFFTztBQUNORixNQUFBQSxHQUFHLEdBQUdHLE1BQU0sQ0FBQ0gsR0FBRCxDQUFaO0FBQ0E7O0FBQ0QsUUFBSUgsU0FBUyxDQUFDSSxNQUFWLENBQWlCSCxDQUFDLEdBQUcsQ0FBckIsS0FBMkIsR0FBL0IsRUFBb0M7QUFDbkNFLE1BQUFBLEdBQUcsR0FBR0osR0FBRyxLQUFLSSxHQUFkO0FBQ0EsS0FGRCxNQUVPO0FBQ05BLE1BQUFBLEdBQUcsR0FBR0osR0FBRyxJQUFJSSxHQUFiO0FBQ0E7O0FBQ0QsUUFBSUgsU0FBUyxDQUFDSSxNQUFWLENBQWlCSCxDQUFqQixLQUF1QixHQUEzQixFQUFnQztBQUMvQkYsTUFBQUEsR0FBRyxJQUFJSSxHQUFHLEdBQUcsVUFBYjtBQUNBLEtBRkQsTUFFTztBQUNOSixNQUFBQSxHQUFHLElBQUlJLEdBQVA7QUFDQTtBQUNEOztBQUNELFNBQU9KLEdBQVA7QUFDQTs7QUFFRCxTQUFTUSxjQUFULENBQXdCQyxLQUF4QixFQUErQjtBQUM5QixRQUFNQyxVQUFVLEdBQUcsRUFBbkI7QUFDQSxNQUFJQyxHQUFHLEdBQUcsRUFBVjs7QUFDQSxPQUFLLElBQUlULENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUdPLEtBQUssQ0FBQ04sTUFBMUIsRUFBa0NELENBQUMsRUFBbkMsRUFBdUM7QUFDdEMsUUFBSVUsUUFBUSxHQUFHSCxLQUFLLENBQUNILFVBQU4sQ0FBaUJKLENBQWpCLENBQWY7O0FBRUEsUUFBSSxNQUFNVSxRQUFWLEVBQW9CO0FBQ25CRixNQUFBQSxVQUFVLENBQUNDLEdBQUcsRUFBSixDQUFWLEdBQW9CQyxRQUFwQjtBQUNBLEtBRkQsTUFFTztBQUNOLFVBQUksT0FBT0EsUUFBWCxFQUFxQjtBQUNwQkYsUUFBQUEsVUFBVSxDQUFDQyxHQUFHLEVBQUosQ0FBVixHQUFxQkMsUUFBUSxJQUFJLENBQWIsR0FBa0IsR0FBdEM7QUFDQSxPQUZELE1BRU87QUFDTixZQUNDLFVBQVVBLFFBQVEsR0FBRyxLQUFyQixLQUNBVixDQUFDLEdBQUcsQ0FBSixHQUFRTyxLQUFLLENBQUNOLE1BRGQsSUFFQSxVQUFVTSxLQUFLLENBQUNILFVBQU4sQ0FBaUJKLENBQUMsR0FBRyxDQUFyQixJQUEwQixLQUFwQyxDQUhELEVBSUU7QUFDRFUsVUFBQUEsUUFBUSxHQUNQLFNBQ0MsQ0FBQ0EsUUFBUSxHQUFHLElBQVosS0FBcUIsRUFEdEIsS0FFQ0gsS0FBSyxDQUFDSCxVQUFOLENBQWlCLEVBQUVKLENBQW5CLElBQXdCLElBRnpCLENBREQ7QUFJQVEsVUFBQUEsVUFBVSxDQUFDQyxHQUFHLEVBQUosQ0FBVixHQUFxQkMsUUFBUSxJQUFJLEVBQWIsR0FBbUIsR0FBdkM7QUFDQUYsVUFBQUEsVUFBVSxDQUFDQyxHQUFHLEVBQUosQ0FBVixHQUFzQkMsUUFBUSxJQUFJLEVBQWIsR0FBbUIsRUFBcEIsR0FBMEIsR0FBOUM7QUFDQSxTQVhELE1BV087QUFDTkYsVUFBQUEsVUFBVSxDQUFDQyxHQUFHLEVBQUosQ0FBVixHQUFxQkMsUUFBUSxJQUFJLEVBQWIsR0FBbUIsR0FBdkM7QUFDQTs7QUFDREYsUUFBQUEsVUFBVSxDQUFDQyxHQUFHLEVBQUosQ0FBVixHQUFzQkMsUUFBUSxJQUFJLENBQWIsR0FBa0IsRUFBbkIsR0FBeUIsR0FBN0M7QUFDQTs7QUFDREYsTUFBQUEsVUFBVSxDQUFDQyxHQUFHLEVBQUosQ0FBVixHQUFxQkMsUUFBUSxHQUFHLEVBQVosR0FBa0IsR0FBdEM7QUFDQTtBQUNEOztBQUNELFNBQU9GLFVBQVA7QUFDQTs7QUFFRCxTQUFTRyxRQUFULENBQWtCSixLQUFsQixFQUF5QkssU0FBekIsRUFBb0M7QUFDbkMsUUFBTUMsVUFBVSxHQUFHRCxTQUFTLENBQUNFLEtBQVYsQ0FBZ0IsR0FBaEIsQ0FBbkI7QUFDQSxRQUFNQyxRQUFRLEdBQUdWLE1BQU0sQ0FBQ1EsVUFBVSxDQUFDLENBQUQsQ0FBWCxDQUFOLElBQXlCLENBQTFDO0FBQ0EsUUFBTUcsTUFBTSxHQUFHWCxNQUFNLENBQUNRLFVBQVUsQ0FBQyxDQUFELENBQVgsQ0FBTixJQUF5QixDQUF4QztBQUVBLFFBQU1MLFVBQVUsR0FBR0YsY0FBYyxDQUFDQyxLQUFELENBQWpDO0FBRUEsTUFBSVUsY0FBYyxHQUFHRixRQUFyQjs7QUFDQSxPQUFLLElBQUlmLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUdRLFVBQVUsQ0FBQ1AsTUFBL0IsRUFBdUNELENBQUMsRUFBeEMsRUFBNEM7QUFDM0NpQixJQUFBQSxjQUFjLElBQUlULFVBQVUsQ0FBQ1IsQ0FBRCxDQUE1QjtBQUNBaUIsSUFBQUEsY0FBYyxHQUFHcEIsNEJBQTRCLENBQUNvQixjQUFELEVBQWlCLFFBQWpCLENBQTdDO0FBQ0E7O0FBQ0RBLEVBQUFBLGNBQWMsR0FBR3BCLDRCQUE0QixDQUFDb0IsY0FBRCxFQUFpQixXQUFqQixDQUE3QztBQUVBQSxFQUFBQSxjQUFjLElBQUlELE1BQWxCOztBQUNBLE1BQUlDLGNBQWMsSUFBSSxDQUF0QixFQUF5QjtBQUN4QkEsSUFBQUEsY0FBYyxHQUFHLENBQUNBLGNBQWMsR0FBRyxVQUFsQixJQUFnQyxVQUFqRDtBQUNBOztBQUVELFFBQU1DLGdCQUFnQixHQUFHRCxjQUFjLEdBQUcsT0FBMUM7QUFDQSxTQUFPQyxnQkFBZ0IsQ0FBQ0MsUUFBakIsS0FBOEIsR0FBOUIsSUFBcUNELGdCQUFnQixHQUFHSCxRQUF4RCxDQUFQO0FBQ0E7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7O0FBRU8sU0FBU0ssUUFBVCxDQUFrQmIsS0FBbEIsRUFBeUI7QUFDL0IsU0FBTyxJQUFJYyxPQUFKLENBQWFDLEdBQUQsSUFBU0EsR0FBRyxDQUFDO0FBQUVDLElBQUFBLEtBQUssRUFBRVosUUFBUSxDQUFDSixLQUFELEVBQVFYLGtCQUFSO0FBQWpCLEdBQUQsQ0FBeEIsQ0FBUDtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gVEtLIHZhbHVlIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbGlwZVBTL1RyYWR1emlyLXBhZ2luYXMtd2ViL2Jsb2IvZjNhNDk1NmExYWE5NmI3YTkxMjQ4NjQxNThhNTIwMDgyNzY5NDUyMS9iYWNrZ3JvdW5kL3RyYW5zbGF0aW9uU2VydmljZS5qc1xuY29uc3QgZ29vZ2xlVHJhbnNsYXRlVEtLID0gJzQ0ODQ4Ny45MzI2MDk2NDYnO1xuXG4vL1xuLy8gT2JmdXNjYXRlZCBsb2dpYzogU1RBUlRcbi8vXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1iaXR3aXNlICovXG5cbmZ1bmN0aW9uIHNoaWZ0TGVmdE9yUmlnaHRUaGVuU3VtT3JYb3IobnVtLCBvcHRTdHJpbmcpIHtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBvcHRTdHJpbmcubGVuZ3RoIC0gMjsgaSArPSAzKSB7XG5cdFx0bGV0IGFjYyA9IG9wdFN0cmluZy5jaGFyQXQoaSArIDIpO1xuXHRcdGlmICgnYScgPD0gYWNjKSB7XG5cdFx0XHRhY2MgPSBhY2MuY2hhckNvZGVBdCgwKSAtIDg3O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhY2MgPSBOdW1iZXIoYWNjKTtcblx0XHR9XG5cdFx0aWYgKG9wdFN0cmluZy5jaGFyQXQoaSArIDEpID09ICcrJykge1xuXHRcdFx0YWNjID0gbnVtID4+PiBhY2M7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGFjYyA9IG51bSA8PCBhY2M7XG5cdFx0fVxuXHRcdGlmIChvcHRTdHJpbmcuY2hhckF0KGkpID09ICcrJykge1xuXHRcdFx0bnVtICs9IGFjYyAmIDQyOTQ5NjcyOTU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG51bSBePSBhY2M7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBudW07XG59XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybVF1ZXJ5KHF1ZXJ5KSB7XG5cdGNvbnN0IGJ5dGVzQXJyYXkgPSBbXTtcblx0bGV0IGlkeCA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IHF1ZXJ5Lmxlbmd0aDsgaSsrKSB7XG5cdFx0bGV0IGNoYXJDb2RlID0gcXVlcnkuY2hhckNvZGVBdChpKTtcblxuXHRcdGlmICgxMjggPiBjaGFyQ29kZSkge1xuXHRcdFx0Ynl0ZXNBcnJheVtpZHgrK10gPSBjaGFyQ29kZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKDIwNDggPiBjaGFyQ29kZSkge1xuXHRcdFx0XHRieXRlc0FycmF5W2lkeCsrXSA9IChjaGFyQ29kZSA+PiA2KSB8IDE5Mjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHQ1NTI5NiA9PSAoY2hhckNvZGUgJiA2NDUxMikgJiZcblx0XHRcdFx0XHRpICsgMSA8IHF1ZXJ5Lmxlbmd0aCAmJlxuXHRcdFx0XHRcdDU2MzIwID09IChxdWVyeS5jaGFyQ29kZUF0KGkgKyAxKSAmIDY0NTEyKVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRjaGFyQ29kZSA9XG5cdFx0XHRcdFx0XHQ2NTUzNiArXG5cdFx0XHRcdFx0XHQoKGNoYXJDb2RlICYgMTAyMykgPDwgMTApICtcblx0XHRcdFx0XHRcdChxdWVyeS5jaGFyQ29kZUF0KCsraSkgJiAxMDIzKTtcblx0XHRcdFx0XHRieXRlc0FycmF5W2lkeCsrXSA9IChjaGFyQ29kZSA+PiAxOCkgfCAyNDA7XG5cdFx0XHRcdFx0Ynl0ZXNBcnJheVtpZHgrK10gPSAoKGNoYXJDb2RlID4+IDEyKSAmIDYzKSB8IDEyODtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRieXRlc0FycmF5W2lkeCsrXSA9IChjaGFyQ29kZSA+PiAxMikgfCAyMjQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ynl0ZXNBcnJheVtpZHgrK10gPSAoKGNoYXJDb2RlID4+IDYpICYgNjMpIHwgMTI4O1xuXHRcdFx0fVxuXHRcdFx0Ynl0ZXNBcnJheVtpZHgrK10gPSAoY2hhckNvZGUgJiA2MykgfCAxMjg7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBieXRlc0FycmF5O1xufVxuXG5mdW5jdGlvbiBjYWxjSGFzaChxdWVyeSwgd2luZG93VGtrKSB7XG5cdGNvbnN0IHRra1NwbGl0ZWQgPSB3aW5kb3dUa2suc3BsaXQoJy4nKTtcblx0Y29uc3QgdGtrSW5kZXggPSBOdW1iZXIodGtrU3BsaXRlZFswXSkgfHwgMDtcblx0Y29uc3QgdGtrS2V5ID0gTnVtYmVyKHRra1NwbGl0ZWRbMV0pIHx8IDA7XG5cblx0Y29uc3QgYnl0ZXNBcnJheSA9IHRyYW5zZm9ybVF1ZXJ5KHF1ZXJ5KTtcblxuXHRsZXQgZW5jb25kaW5nUm91bmQgPSB0a2tJbmRleDtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBieXRlc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG5cdFx0ZW5jb25kaW5nUm91bmQgKz0gYnl0ZXNBcnJheVtpXTtcblx0XHRlbmNvbmRpbmdSb3VuZCA9IHNoaWZ0TGVmdE9yUmlnaHRUaGVuU3VtT3JYb3IoZW5jb25kaW5nUm91bmQsICcrLWFeKzYnKTtcblx0fVxuXHRlbmNvbmRpbmdSb3VuZCA9IHNoaWZ0TGVmdE9yUmlnaHRUaGVuU3VtT3JYb3IoZW5jb25kaW5nUm91bmQsICcrLTNeK2IrLWYnKTtcblxuXHRlbmNvbmRpbmdSb3VuZCBePSB0a2tLZXk7XG5cdGlmIChlbmNvbmRpbmdSb3VuZCA8PSAwKSB7XG5cdFx0ZW5jb25kaW5nUm91bmQgPSAoZW5jb25kaW5nUm91bmQgJiAyMTQ3NDgzNjQ3KSArIDIxNDc0ODM2NDg7XG5cdH1cblxuXHRjb25zdCBub3JtYWxpemVkUmVzdWx0ID0gZW5jb25kaW5nUm91bmQgJSAxMDAwMDAwO1xuXHRyZXR1cm4gbm9ybWFsaXplZFJlc3VsdC50b1N0cmluZygpICsgJy4nICsgKG5vcm1hbGl6ZWRSZXN1bHQgXiB0a2tJbmRleCk7XG59XG5cbi8qIGVzbGludC1lbmFibGUgbm8tYml0d2lzZSAqL1xuLy9cbi8vIE9iZnVzY2F0ZWQgbG9naWM6IEVORFxuLy9cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRva2VuKHF1ZXJ5KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzKSA9PiByZXMoeyB2YWx1ZTogY2FsY0hhc2gocXVlcnksIGdvb2dsZVRyYW5zbGF0ZVRLSykgfSkpO1xufVxuIl0sImZpbGUiOiJ0cmFuc2xhdG9ycy9Hb29nbGVUcmFuc2xhdG9yL3Rva2VuLmpzIn0=
